<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:p="http://primefaces.org/ui" template="/layout/template.xhtml">
	<ui:define name="body">
		<h1 class="title ui-widget-header ui-corner-all">Movimiento	Mercadería</h1>
		<h:form id="formMovMerc">
			<p:growl id="message" showDetail="true" />
			<p:panel header="#{message['panel.ingreso.mercaderia']}">
				<p:panelGrid columns="6">
					<h:outputText value="#{message['movimiento.tipo']}" />
					<h:selectOneMenu   id="idtipokardex" valueChangeListener="#{movimientoMercaderia.cambioTipo}"
						value="#{movimientoMercaderia.idtipokardexproducto}"   onchange="submit()">
						<f:selectItem itemLabel="Seleccionar tipo de kardex" itemValue="-1" />
						<f:selectItems id="tipokardex" value="#{movimientoMercaderia.tipoKardexItems}" />
					</h:selectOneMenu>
					<p:message for="idtipokardex" />
					<h:outputText value="#{message['mantenimiento.producto.cantidadEnt']}" rendered="#{movimientoMercaderia.editMode}" />
					<p:spinner id="cantEntrada" min="1" value="#{movimientoMercaderia.objKardexSie.cantentrada}" 
					rendered="#{movimientoMercaderia.editMode}" requiredMessage="#{message['movimiento.cantEntrada.validation']}"  >
						<f:validateLength minimum="1" />
						</p:spinner>
						 <p:message for="cantEntrada" />
					<h:outputText value="#{message['mantenimiento.producto.cantidadSal']}" rendered="#{!movimientoMercaderia.editMode}"  />
					<p:spinner id="cantSalida" min="1"
						value="#{movimientoMercaderia.objKardexSie.cantsalida}" rendered="#{!movimientoMercaderia.editMode}"   >
						<f:validateLength minimum="1" />
						</p:spinner>
						 <p:message for="cantSalida" />
					<h:outputText value="#{message['mantenimiento.producto.tipo']}" />
					<p:selectOneMenu id="tipoProd" value="#{comboAction.tipoProducto}" required="true" >
						<f:selectItem itemLabel="Seleccionar tipo" itemValue="-1" />
						<f:selectItems value="#{comboAction.tipoitems}" />
						  <p:ajax update="produc"  listener="#{comboAction.cambiar}"/>
					</p:selectOneMenu>
					<p:message for="tipoProd" />
					<h:outputText value="#{message['mantenimiento.producto']}" />
					<p:selectOneMenu  id="produc" value="#{movimientoMercaderia.idproducto}" 
					required="true"  >
						<f:selectItem itemLabel="Seleccione Producto" itemValue="-1" />
						<f:selectItems value="#{comboAction.productositems}" />
					</p:selectOneMenu>
					<p:message for="produc" />
				 
					<h:outputText value="#{message['mantenimiento.kardex.almacen']}" />
					<p:selectOneMenu id="idAlmacen" size="1" required="true" 
						value="#{movimientoMercaderia.idAlmacen}">
						<f:selectItem itemLabel="Seleccione" itemValue="-1" />
						<f:selectItems value="#{comboAction.almacenItems}" />
					</p:selectOneMenu>
					
					<h:outputText value="Detalle" id="detProd" />
				<p:inputTextarea  
						value="#{movimientoMercaderia.objKardexSie.detallekardex}"
						  />
						
					<p:message for="idAlmacen" />
				 <p:commandButton id="btn_add" value="Añadir"
						update=":formMovMerc: message"
						actionListener="#{movimientoMercaderia.anadir}"
					  ajax="false">
						</p:commandButton>
				</p:panelGrid>
				
				<p:dataTable id="listaMovim" value="#{movimientoMercaderia.data}" var="d">
				 <p:column>
						<f:facet name="header">
							<h:outputText value="Item" />
						</f:facet>
						<h:outputText value="#{d.item}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Tipo de Kardex" />
						</f:facet>
						<h:outputText value="#{d.tbTipoKardexProducto.descripcion}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Producto" />
						</f:facet>
						<h:outputText value="#{d.tbProducto.descripcionproducto}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Cant. Entrada" />
						</f:facet>
						<h:outputText value="#{d.cantentrada}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Cant. Salida" />
						</f:facet>
						<h:outputText value="#{d.cantsalida}" />
					</p:column>
						<p:column>
						<f:facet name="header">
							<h:outputText value="Tipo Kardex" />
						</f:facet>
						<h:outputText value="#{d.tipokardex}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Quitar" />
						</f:facet> 
							 <p:commandButton id="showConfirmMovim" value="Quitar" icon="ui-icon ui-icon-pencil" 
							  actionListener="#{movimientoMercaderia.quitar}" update=":formMovMerc:listaMovim"  > 
							 	<f:attribute    name="d" value="#{d.item}"  />
					</p:commandButton>
					    
					</p:column> 
				</p:dataTable> 
				<p:commandButton id="id"
					actionListener="#{movimientoMercaderia.insertar}"
					value="Grabar Mercadería" ajax="false"
					update="formMovMerc: message">
				</p:commandButton>
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>